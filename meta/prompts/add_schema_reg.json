{
  "task": "Add local schema registry for offline $ref resolution",
  "objective": "Ensure absolute $ref URLs like https://schemas.synesthetic.dev/{version}/... resolve to local files in libs/synesthetic-schemas/schemas during validation.",
  "rules": [
    "In mcp/validate.py, add a helper _build_local_registry() that loads all *.json schemas from libs/synesthetic-schemas/schemas",
    "Parse version string dynamically from libs/synesthetic-schemas/version.json",
    "Register each schema in referencing.Registry using its canonical URL (https://schemas.synesthetic.dev/{version}/{fname}) mapped to Resource.from_contents(...)",
    "In validate_asset, construct Draft202012Validator with registry=_build_local_registry() instead of default",
    "Keep fallback behavior if submodule path not present (registry empty)",
    "Do not add new dependencies; only use referencing, json, pathlib, os"
  ]
}
